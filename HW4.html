<!DOCTYPE HTML>
<!--
	Read Only by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Read Only by HTML5 UP</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
        <style>
        .controls { 
            background-color: #fff; 
            padding: 20px; 
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            display: flex; 
            gap: 25px;
            align-items: flex-end;
            justify-content: center;
            flex-wrap: wrap;
        }
        .controls div { 
            display: flex; 
            flex-direction: column; 
            flex-grow: 1;
            max-width: 150px;
        }
        .controls label { 
            font-weight: bold; 
            margin-bottom: 8px;
            font-size: 1em;
            color: #555; 
        }
        .controls input { 
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            width: 100%;
            box-sizing: border-box;
            font-size: 1em;
        }
        .controls button { 
            padding: 12px 25px;
            background-color: #007bff; 
            color: white; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
            font-size: 1.1em;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
        }
        .controls button:hover { 
            background-color: #0056b3; 
            transform: translateY(-2px);
        }
        .controls button.reset-zoom {
            background-color: #6c757d;
        }
        .controls button.reset-zoom:hover {
            background-color: #5a6268;
        }
        
        /* Contenitori per i grafici */
      /* Contenitori per i grafici (3 righe) */
            .chart-container-row1, .chart-container-row2, .chart-container-row3 { 
                display: flex; 
                width: 100%; 
                gap: 20px; 
            }
            .chart-container-row1 { height: 700px; } /* Riga 1 (Grafici 1 & 2) */
            .chart-container-row2 { height: 500px; margin-top: 20px; } /* Riga 2 (Grafico 3) */
            .chart-container-row3 { height: 600px; margin-top: 20px; } /* Riga 3 (Grafico 4) */

        /* Stili per i box dei grafici */
        .chart-box { 
            background: #fff; 
            padding: 20px;
            border-radius: 10px; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); 
        }
        .main-chart { flex: 3; }
        .histogram { flex: 1; }
        .cumulative-chart { flex: 1; }
        .cumulative-histogram { flex: 1; } /* Ora occupa tutta la riga 3 */

    </style>
	</head>
	<body class="is-preload">

		<!-- Header -->
			<section id="header">
				<header>
					<span class="image avatar"><img src="images/avatar.jpg" alt="" /></span>
					<h1 id="logo"><a href="#">Alessio Mareschi</a></h1>
					<p><a href="index.html">Home</a></p>
					
				</header>
				
				<footer>
					<ul class="icons">
						<li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
						<li><a href="#" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
						<li><a href="#" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
						<li><a href="#" class="icon brands fa-github"><span class="label">Github</span></a></li>
						<li><a href="#" class="icon solid fa-envelope"><span class="label">Email</span></a></li>
					</ul>
				</footer>
			</section>

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">

						<!-- One -->
							<section id="one">
								<div class="image main" data-position="center">
									<img src="images/HW1_image.png" alt="" />
								</div>
								<div class="container">
									<header class="major">
										<h2>Homework 4</h2>
										<p>Law of large numbers</p>
									</header>
								</div>
							</section>

							<!-- Two -->
							<section id="two">
                                
								<div class="container">
                                    
									

									<h1>Simulation of Law of Large Numbers (LLN) & Central Limit Theorem (CLT)</h1>
                                    
    <div class="controls">
        <div>
            <label for="probP">Probability (p)</label>
            <input type="number" id="probP" value="0.5" min="0.01" max="0.99" step="0.01">
        </div>
        <div>
            <label for="trialsN">Trials per trajectory (n)</label>
            <input type="number" id="trialsN" value="100" min="10" step="10">
        </div>
        <div>
            <label for="trajectoriesM">Number of trajectories (m)</label>
            <input type="number" id="trajectoriesM" value="50" min="1" step="1">
        </div>
        <button id="runButton">Run Simulation</button>
        <button id="resetZoomButton" class="reset-zoom">Reset Zoom</button>
    </div>

    <div class="chart-container-row1">
        <div class="chart-box main-chart">
            <canvas id="trajectoryChart"></canvas>
        </div>
        <div class="chart-box histogram">
            <canvas id="histogramChart"></canvas>
        </div>
    </div>

    <div class="chart-container-row2">
        <div class="chart-box cumulative-chart">
            <canvas id="cumulativeChart"></canvas>
        </div>
    </div>

    <div class="chart-container-row3">
        <div class="chart-box cumulative-histogram">
            <canvas id="cumulativeHistogramChart"></canvas>
        </div>
    </div>


    <script>
        // Riferimenti agli elementi
        const runButton = document.getElementById("runButton");
        const resetZoomButton = document.getElementById("resetZoomButton");
        const probP_input = document.getElementById("probP");
        const trialsN_input = document.getElementById("trialsN");
        const trajectoriesM_input = document.getElementById("trajectoriesM");
        
        // Contesti per i 4 canvas
        const trajCtx = document.getElementById("trajectoryChart").getContext("2d");
        const histCtx = document.getElementById("histogramChart").getContext("2d");
        const cumCtx = document.getElementById("cumulativeChart").getContext("2d"); 
        const cumHistCtx = document.getElementById("cumulativeHistogramChart").getContext("2d"); // Nuovo

        // Variabili globali per i 4 grafici
        let trajectoryChart;
        let histogramChart;
        let cumulativeChart; 
        let cumulativeHistogramChart; // Nuovo

        // Funzione helper per l'istogramma 1 (Frequenze)
        function buildHistogramData(data, p) {
            const binCount = 20; 
            const min = Math.min(...data);
            const max = Math.max(...data);
            let range = Math.max(p - min, max - p) * 2.1;
            if (range === 0 || !isFinite(range)) { range = 0.1; }
            const histMin = p - range / 2;
            const histMax = p + range / 2;
            let binSize = (histMax - histMin) / binCount;
            const bins = Array(binCount).fill(0);
            const labels = [];
            if (binSize === 0) {
                binSize = 1; 
                for (let i = 0; i < binCount; i++) { labels.push(''); }
                const centerBin = Math.floor(binCount / 2);
                bins[centerBin] = data.length;
                labels[centerBin] = data[0].toFixed(3);
            } else {
                for (let i = 0; i < binCount; i++) {
                    const binStart = histMin + i * binSize;
                    labels.push(`${binStart.toFixed(3)}`);
                }
                data.forEach(value => {
                    let binIndex = Math.floor((value - histMin) / binSize);
                    if (binIndex < 0) binIndex = 0;
                    if (binIndex >= binCount) binIndex = binCount - 1;
                    bins[binIndex]++;
                });
            }
            return { labels, counts: bins };
        }
        
        // NUOVA Funzione helper per l'istogramma 2 (Conteggi)
        function buildCountHistogramData(data, expectedValue) {
            const binCount = 30; // Più bin per una gaussiana più definita
            const min = Math.min(...data);
            const max = Math.max(...data);

            let range = Math.max(expectedValue - min, max - expectedValue) * 2.1;
            if (range === 0 || !isFinite(range)) { range = 20; } // Un range di default

            // Assicura che il range sia almeno 1 per bin
            if (range < binCount) { range = binCount; }
            
            // Arrotonda per avere bin di numeri interi
            range = Math.ceil(range);

            const histMin = Math.floor(expectedValue - range / 2);
            const histMax = Math.ceil(expectedValue + range / 2);
            
            let binSize = Math.ceil((histMax - histMin) / binCount);
            if (binSize === 0) { binSize = 1; }

            const actualBinCount = Math.ceil((histMax - histMin) / binSize);
            const bins = Array(actualBinCount).fill(0);
            const labels = [];

            for (let i = 0; i < actualBinCount; i++) {
                const binStart = histMin + i * binSize;
                labels.push(`${binStart}`);
            }

            data.forEach(value => {
                let binIndex = Math.floor((value - histMin) / binSize);
                if (binIndex < 0) binIndex = 0;
                if (binIndex >= actualBinCount) binIndex = actualBinCount - 1;
                bins[binIndex]++;
            });
            
            return { labels, counts: bins };
        }

        // Funzione principale simulazione
        function runSimulation() {
            try {
                const p = parseFloat(probP_input.value);
                const n = parseInt(trialsN_input.value);
                const m = parseInt(trajectoriesM_input.value);

                if (isNaN(p) || isNaN(n) || isNaN(m) || n <= 0 || m <= 0 || p < 0 || p > 1) {
                    alert("Per favore, inserisci valori validi:\n - p: (0.0 - 1.0)\n - n: > 0\n - m: > 0");
                    return;
                }

                const labels = Array.from({ length: n }, (_, i) => i + 1); 
                const trajectoryDatasets = []; 
                const finalFrequencies = [];   
                const cumulativeDatasets = []; 
                const finalCounts = []; // Nuovo: per il 4° grafico
                const expectedLine = []; 

                const expectedCount = p * n; // Valore atteso per i conteggi

                for (let j = 1; j <= n; j++) {
                    expectedLine.push(p * j);
                }

                for (let i = 0; i < m; i++) {
                    const trajectoryData = []; 
                    const cumulativeData = []; 
                    let successCount = 0;

                    for (let j = 1; j <= n; j++) {
                        if (Math.random() < p) { 
                            successCount++; 
                        }
                        trajectoryData.push(successCount / j);
                        cumulativeData.push(successCount); 
                    }
                    
                    trajectoryDatasets.push({
                        label: `Traiettoria ${i + 1}`, data: trajectoryData,
                        borderColor: `rgba(${Math.random() * 255}, ${Math.random() * 255}, ${Math.random() * 255}, 0.5)`,
                        borderWidth: 1.5, pointRadius: 0, fill: false
                    });
                    
                    finalFrequencies.push(trajectoryData[trajectoryData.length - 1]);
                    
                    cumulativeDatasets.push({
                        label: `Traiettoria ${i + 1}`, data: cumulativeData,
                        borderColor: `rgba(${Math.random() * 255}, ${Math.random() * 255}, ${Math.random() * 255}, 0.5)`,
                        borderWidth: 1.5, pointRadius: 0, fill: false, stepped: true 
                    });
                    
                    finalCounts.push(successCount); // Salva il conteggio finale
                }

                trajectoryDatasets.push({
                    label: `Probabilità p = ${p}`, data: Array(n).fill(p), 
                    borderColor: 'red', borderWidth: 4, pointRadius: 0, fill: false
                });

                cumulativeDatasets.push({
                    label: `Valore Atteso (p*n)`, data: expectedLine, 
                    borderColor: 'blue', borderWidth: 4, pointRadius: 0, fill: false
                });

                // --- Disegna GRAFICO 1 (Traiettorie) ---
                if (trajectoryChart) { trajectoryChart.destroy(); }
                trajectoryChart = new Chart(trajCtx, {
                    type: 'line', data: { labels: labels, datasets: trajectoryDatasets },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { 
                            legend: { display: false }, tooltip: { enabled: false }, 
                            title: { display: true, text: `(1) Convergenza Frequenza Relativa f(n)`, font: { size: 18, weight: 'bold' } },
                            zoom: { zoom: { wheel: { enabled: true }, pinch: { enabled: true }, mode: 'xy' }, pan: { enabled: true, mode: 'xy' } }
                        },
                        scales: {
                            x: { title: { display: true, text: 'Numero di prove (n)', font: { size: 16 } }, ticks: { font: { size: 12 } } },
                            y: { title: { display: true, text: 'Frequenza Relativa f(n)', font: { size: 16 } }, ticks: { font: { size: 12 } }, min: 0, max: 1 }
                        }, animation: { duration: 0 }
                    }
                });

                // --- Disegna GRAFICO 2 (Istogramma Frequenze) ---
                const histData = buildHistogramData(finalFrequencies, p);
                if (histogramChart) { histogramChart.destroy(); }
                histogramChart = new Chart(histCtx, {
                    type: 'bar',
                    data: { labels: histData.labels, datasets: [{ label: 'Distribuzione di f(n) (valori finali)', data: histData.counts, backgroundColor: 'rgba(0, 123, 255, 0.8)' }] },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { 
                            legend: { display: false }, 
                            title: { display: true, text: `(2) Distribuzione f(n)`, font: { size: 18, weight: 'bold' } },
                            zoom: { zoom: { wheel: { enabled: true }, pinch: { enabled: true }, mode: 'xy' }, pan: { enabled: true, mode: 'xy' } }
                        },
                        scales: {
                            x: { title: { display: true, text: 'Valore f(n)', font: { size: 16 } }, ticks: { autoSkip: true, maxRotation: 45, minRotation: 0, font: { size: 12 } } },
                            y: { title: { display: true, text: 'Conteggio (su m)', font: { size: 16 } }, ticks: { font: { size: 12 } } }
                        }
                    }
                });
                
                // --- Disegna GRAFICO 3 (Cumulativo) ---
                if (cumulativeChart) { cumulativeChart.destroy(); }
                cumulativeChart = new Chart(cumCtx, {
                    type: 'line', data: { labels: labels, datasets: cumulativeDatasets },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { 
                            legend: { display: false }, tooltip: { enabled: true }, 
                            title: { display: true, text: `(3) Conteggio Cumulativo Successi S(n)`, font: { size: 18, weight: 'bold' } },
                            zoom: { zoom: { wheel: { enabled: true }, pinch: { enabled: true }, mode: 'xy' }, pan: { enabled: true, mode: 'xy' } }
                        },
                        scales: {
                            x: { title: { display: true, text: 'Numero di prove (n)', font: { size: 16 } }, ticks: { font: { size: 12 } } },
                            y: { title: { display: true, text: 'Numero Totale Successi', font: { size: 16 } }, ticks: { font: { size: 12 } } }
                        }, animation: { duration: 0 }
                    }
                });

                // --- Disegna GRAFICO 4 (Istogramma Conteggi) --- (Nuovo)
                const cumHistData = buildCountHistogramData(finalCounts, expectedCount);
                if (cumulativeHistogramChart) { cumulativeHistogramChart.destroy(); }
                cumulativeHistogramChart = new Chart(cumHistCtx, {
                    type: 'bar',
                    data: { labels: cumHistData.labels, datasets: [{ label: 'Distribuzione di S(n) (valori finali)', data: cumHistData.counts, backgroundColor: 'rgba(40, 167, 69, 0.8)' }] }, // Colore verde
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { 
                            legend: { display: false }, 
                            title: { display: true, text: `(4) Distribuzione S(n)`, font: { size: 18, weight: 'bold' } },
                            zoom: { zoom: { wheel: { enabled: true }, pinch: { enabled: true }, mode: 'xy' }, pan: { enabled: true, mode: 'xy' } }
                        },
                        scales: {
                            x: { title: { display: true, text: 'Conteggio finale S(n)', font: { size: 16 } }, ticks: { autoSkip: true, maxRotation: 45, minRotation: 0, font: { size: 12 } } },
                            y: { title: { display: true, text: 'Conteggio (su m)', font: { size: 16 } }, ticks: { font: { size: 12 } } }
                        }
                    }
                });


            } catch (e) {
                alert("Si è verificato un errore nello script. Assicurati di essere connesso a internet.\n\nDettagli: " + e.message);
                console.error(e);
            }
        }

        // Funzione per resettare lo zoom su TUTTI i grafici
        function resetZoom() {
            if (trajectoryChart) { trajectoryChart.resetZoom(); }
            if (histogramChart) { histogramChart.resetZoom(); }
            if (cumulativeChart) { cumulativeChart.resetZoom(); }
            if (cumulativeHistogramChart) { cumulativeHistogramChart.resetZoom(); } // Nuovo
        }

        // --- Esecuzione ---
        runButton.addEventListener("click", runSimulation);
        resetZoomButton.addEventListener("click", resetZoom);
        
        runSimulation(); // Esegui al caricamento
        
    </script>

									



								</div>


								


							</section>

						
						<!-- Three -->
							

						

						

					</div>

				<!-- Footer -->
					<section id="footer">
						<div class="container">
							<ul class="copyright">
								<li>&copy; Untitled. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
							</ul>
						</div>
					</section>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>